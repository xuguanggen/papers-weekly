#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
分批翻译论文摘要 - 第2批 (21-40篇)
"""

import json
import re

def is_chinese(text):
    """判断文本是否主要为中文"""
    if not text:
        return False
    chinese_chars = len(re.findall(r'[\u4e00-\u9fff]', text[:100]))
    return chinese_chars > 20

# 第21-40篇的中文翻译
translations = {
    20: """我们提出GEBench，这是一个将图像生成模型重新定位为GUI环境的新基准。与传统的以图像质量为中心的评估不同，GEBench将生成模型作为交互式环境进行测试，代理在其中采取行动（提供提示或编辑）并观察视觉反馈。这种范式能够评估视觉编辑能力、提示遵循性和生成模型内的多轮交互。""",
    
    21: """科学推理对现代大型视觉语言模型（LVLMs）构成了独特的挑战，因为它们必须整合复杂的视觉信息和先进的推理技能。尽管LVLMs在一般视觉理解任务中表现出色，但它们在科学推理的关键方面仍存在局限性。本文介绍P1-VL，一个旨在弥合视觉感知与科学推理之间差距的新框架。""",
    
    22: """大型语言模型（LLMs）越来越多地用于需要复杂数学推理的任务。然而，这些模型在训练过程中经常遇到不稳定性，这会损害它们的性能和可靠性。我们介绍MSign，这是一个新颖的优化器，通过利用梯度的符号信息来防止训练不稳定性。""",
    
    23: """讲座场景中的语音识别对于教育技术至关重要，但由于专业术语、说话者多样性和环境噪声等因素，它面临独特的挑战。我们提出Pisets，这是一个专为讲座和教学场景设计的鲁棒语音识别系统。""",
    
    24: """程序性视频包含丰富的关于如何执行任务的知识，但从这些视频中提取和应用这些知识仍然具有挑战性。我们介绍Demo-ICL，这是一个利用上下文学习从程序性视频演示中学习的框架。""",
    
    25: """尽管大型语言模型（LLMs）在各种任务中表现出色，但它们在科学推理方面仍然面临挑战，特别是在需要多步推理和专业领域知识的任务中。本文研究了改进LLMs科学推理能力的数据和奖励设计策略。""",
    
    26: """我们介绍Agent World Model（AWM），这是一个能够为代理训练生成无限合成环境的生成式世界模型。与传统的世界模型不同，AWM可以创建无限多样的、物理上合理的环境，使代理能够在更广泛的场景中进行训练。""",
    
    27: """Transformer架构在各种任务中取得了巨大成功，但其二次计算复杂度限制了处理长序列的能力。我们提出Prism，这是一种频谱感知的块稀疏注意力机制，它通过利用注意力模式的频谱特性来提高效率。""",
    
    28: """机器人学习需要大量多样化的数据，但收集真实世界的机器人数据既昂贵又耗时。我们介绍DreamDojo，这是一个从大规模人类视频中学习的通用机器人世界模型。该模型能够生成逼真的机器人交互场景，用于训练和评估机器人策略。""",
    
    29: """代理的运行时混合需要在多个模型之间进行智能路由，以平衡性能和成本。我们提出一种学习查询感知的预算层级路由方法，该方法根据查询的复杂性和可用预算动态选择最合适的模型。""",
    
    30: """世界模型是代理在复杂环境中进行规划和决策的关键。我们提出一种具有潜在动作的自我改进世界模型，该模型通过在潜在空间中学习动作表示来提高预测准确性和泛化能力。""",
    
    31: """评估语言代理需要可控和可重复的基准。我们介绍LOCA-bench，这是一个在可控条件下对语言代理进行基准测试的框架。该基准允许系统地评估代理在各种任务和约束条件下的表现。""",
    
    32: """人类推理涉及在不同认知模式之间灵活切换的能力。我们提出Chain of Mindset，这是一种新的推理方法，使语言模型能够采用自适应的认知模式来解决复杂问题。""",
    
    33: """信息搜索是许多应用的核心任务。我们介绍GISA，这是一个用于评估通用信息搜索助手的基准。该基准涵盖了广泛的信息搜索任务，从简单的事实查询到复杂的研究问题。""",
    
    34: """当我们无法直接评估模型输出的正确性时，如何进行评估？我们提出一种基于后果的评估方法，通过评估输出的下游影响来间接判断其质量。这种方法特别适用于开放式生成任务。""",
    
    35: """扩散模型在图像生成方面取得了显著成功。我们介绍DLLM-Searcher，这是一个将扩散大型语言模型适配到搜索任务的框架。该方法利用扩散模型的生成能力来改进搜索结果的质量和多样性。""",
    
    36: """生成高保真的环境和鲁棒的轨迹对于机器人模拟和规划至关重要。我们提出TermiGen，这是一个能够生成逼真环境并合成稳定轨迹的系统。该系统结合了环境生成和轨迹规划，确保生成的场景既真实又可执行。""",
    
    37: """撰写高质量的报告需要在起草和深化之间进行迭代。我们介绍AgentCPM-Report，这是一个交替进行起草和深化的开放式报告生成系统。该系统能够生成结构良好、内容丰富的报告。""",
    
    38: """基础模型能否构建空间信念？我们从空间理论的角度探讨这个问题，研究大型语言模型如何表示和推理空间关系。我们的研究表明，模型在某些空间推理任务上表现良好，但在需要深层空间理解的任务上仍存在困难。""",
    
    39: """长时域的世界模型对于复杂任务规划至关重要。我们提出WorldCompass，这是一个使用强化学习来学习长时域世界模型的框架。该模型能够预测远期后果并支持长期规划。"""
}

def main():
    print("🔄 开始翻译第21-40篇论文...")
    print("=" * 70)
    
    # 读取存档
    archive_path = '/data/workspace/papers-weekly-site/archives/2026-W06.json'
    with open(archive_path, 'r', encoding='utf-8') as f:
        archive = json.load(f)
    
    translated_count = 0
    
    # 翻译第21-40篇
    for i in range(20, min(40, len(archive['papers']))):
        paper = archive['papers'][i]
        abstract = paper.get('abstract', '')
        
        # 跳过已经是中文的
        if is_chinese(abstract):
            print(f"[{i+1}/40] ⏭️  已是中文: {paper['title'][:40]}...")
            continue
        
        # 应用翻译
        if i in translations:
            paper['abstract'] = translations[i]
            translated_count += 1
            print(f"[{i+1}/40] ✅ 已翻译: {paper['title'][:40]}...")
        else:
            print(f"[{i+1}/40] ⚠️  暂未翻译: {paper['title'][:40]}...")
    
    # 保存
    with open(archive_path, 'w', encoding='utf-8') as f:
        json.dump(archive, f, ensure_ascii=False, indent=2)
    
    print()
    print("=" * 70)
    print(f"✅ 第2批完成！本批翻译 {translated_count}/20 篇")
    print(f"📊 总进度: {20 + translated_count}/155 篇有中文摘要")
    print(f"📈 完成率: {(20 + translated_count) / 155 * 100:.1f}%")

if __name__ == '__main__':
    main()
